myLoader=new Image();myLoader.src="/plugins/content/LVSpoiler/LVSpoiler/loading.gif";window.addEvent('domready',function(){var spoilers=$$('.spoiler');function hide_all_spoilers(id){spoilers.each(function(element){if(element.getElement('.sp-head').getProperty('class').test("unfolded")&&element.getElement('.sp-head').get('id')!=id){element.getElement('.sp-head').toggleClass('unfolded').toggleClass('folded');var fx_slide=new Fx.Slide(element.getElement(".sp-body"),{duration:pb_sp_conf.animatespeed}).slideOut();}})}function open_spoiler(id){var spoiler=$$('#'+id+'_spoiler');var fx_sp_opac=new Fx.Morph(spoiler[0].getElement('.sp-body'),{duration:pb_sp_conf.animatespeed,transition:Fx.Transitions.Expo.easeInOut});var fx_sp_slide=new Fx.Slide(spoiler[0].getElement('.sp-body'),{duration:pb_sp_conf.animatespeed,onStart:function(){fx_sp_opac.start({'opacity':[0.5,1]});}}).slideIn();}spoilers.each(function(element){var fx_sp_opac=new Fx.Morph(element.getElement('.sp-body'),{duration:pb_sp_conf.animatespeed,transition:Fx.Transitions.Expo.easeInOut});var fx_sp_slide=new Fx.Slide(element.getElement('.sp-body'),{duration:pb_sp_conf.animatespeed,onStart:function(){fx_sp_opac.start({'opacity':[0.5,1]});}});var opened=element.getElement('.opened').get('value');if(pb_sp_conf.animatedefault==1){fx_sp_slide.hide();if(opened=='1'){var osid=element.getElement('.sp-head').get('id').toInt();open_spoiler(osid);}}else if(opened!='1'){fx_sp_slide.hide();}var makeAction=function(){if(pb_sp_conf.revealtype!="mouseover")makeAction2();else
makeAction2.delay(pb_sp_conf.mouseoverdelay);}
var makeAction2=function(){if(pb_sp_conf.onemustopen==1){var unfoldedSpoilers=$$('div.unfolded');var thisId=element.getElement('.sp-head').get('id');if(unfoldedSpoilers.length==1&&unfoldedSpoilers[0].get('id')==thisId){return;}}if(pb_sp_conf.collapseprev==1){hide_all_spoilers(element.getElement('.sp-head').get('id'));}element.getElement('.sp-head').toggleClass('unfolded').toggleClass('folded');var images=element.getElements('.spoilerimage');var all_images=[];var $href=null;images.each(function(item){$href=item.getProperty("data-src");if($href!='undefined'&&$href!=null){all_images.push($href);}});if(all_images.length>0){element.getElement('.sp-head').toggleClass('loading');var loader=new Asset.images(all_images,{onComplete:function(){images.each(function(item){$href=item.getProperty("data-src");if($href!='undefined'&&$href!=null){item.setProperty("src",$href);item.removeProperty("data-src");}});element.getElement('.sp-head').toggleClass('loading');fx_sp_slide.toggle();}});}else{fx_sp_slide.toggle();}}
element.getElement('.sp-head-click').addEvent(pb_sp_conf.revealtype,makeAction);});});